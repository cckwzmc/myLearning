$(function() {
	$('#userName').blur(function() {
		var userName = $(this).val();
		
		if(userName!=""){
			var data = "-";
			$.getScript("http://passport.zongheng.com/qzdlCheckUserName.do?userName=" + userName);
			
			var timer = setInterval(
				function() {
					if (data=="-") {
						data = $.qzdlCheckUserName;
						return;
					} else {
						clearInterval(timer);
					}
	
					$('#userNameTip').removeClass();
	
					if (data == "T") {
						$('#userNameTip').addClass('zczh_zq');
						$("#ck_name").attr("class", "sure").html("输入正确<br\/>");
						$('#ckname').hide();
						$("#ck_name").show();
					} else if (data == "F") {
						$('#userNameTip').addClass('zczh_cw');
						$("#ck_name").attr("class", "wrong").html("用户名不符合注册规则<br\/>");
						$('#ckname').hide();
						$("#ck_name").show();
					} else if (data == "Y") {
						$('#userNameTip').addClass('zczh_cw');
						$("#ck_name").attr("class", "wrong").html("此用户名已被占用！<br\/>");
						$('#ckname').hide();
						$("#ck_name").show();
					}
				},100);
		}else{
			$('#ckname').show();
			$("#ck_name").hide();
		}
	});
	$('#userName').focus(function() {
		$('#userNameTip').removeClass();
		$('#userNameTip').addClass('zczh_mr');
		$('#ckname').show();
		$("#ck_name").hide()
	});
	$('#nickName').blur(
			function() {
				var nickName = $(this).val();
				if (nickName != "") {
					
					var data = "-";
					$.getScript("http://passport.zongheng.com/qzdlCheckNickName.do?nickName=" + nickName);
					var timer = setInterval(
						function() {
							if (data=="-") {
								data = $.qzdlCheckNickName;
				                return;
				            } else {
				                clearInterval(timer);
				            }
							
							$('#nickNameTip').removeClass();

							if (data == "T") {
								$('#nickNameTip').addClass('zczh_zq');
								$("#ck_nickName").attr("class", "sure").html(
										"输入正确<br\/>");
								$('#cknickName').hide();
								$("#ck_nickName").show()
							} else if (data == "F") {
								$('#nickNameTip').addClass('zczh_cw');
								$("#ck_nickName").attr("class", "wrong").html(
										"纵横昵称不符合注册规则<br\/>");
								$('#cknickName').hide();
								$("#ck_nickName").show()
							} else if (data == "Y") {
								$('#nickNameTip').addClass('zczh_cw');
								$("#ck_nickName").attr("class", "wrong").html(
										"此纵横昵称已经被占用<br\/>");
								$('#cknickName').hide();
								$("#ck_nickName").show()
							}
						},100);
				}else{
					$('#cknickName').show();
					$("#ck_nickName").hide()
				}
			});
	$('#nickName').focus(function() {
		$('#nickNameTip').removeClass();
		$('#nickNameTip').addClass('zczh_mr');
		$('#cknickName').show();
		$("#ck_nickName").hide()
	});
	$('#password').blur(
			function() {
				var password = $(this).val();
				
				$('#suggestion_password').empty();

				if(password!=""){

					$('#passwordTip').removeClass();
	
					if (password.length < 6 || password.length > 16) {
						$('#passwordTip').addClass('zczh_cw');
						$("#ck_passport").attr("class", "wrong").html(
								"密码长度6—16位字符<br\/>");
						$('#ckpassport').hide();
						$("#ck_passport").show();
						return
					}
					var userName = $("#userName").val();
					if (userName == password) {
						$('#passwordTip').addClass('zczh_cw');
						$("#ck_passport").attr("class", "wrong").html(
								"密码不能和用户名相同<br\/>");
						$('#ckpassport').hide();
						$("#ck_passport").show();
						return
					}
					if (password.match(/^[a-zA-Z0-9]{6,16}$/g) == null) {
						$('#passwordTip').addClass('zczh_cw');
						$("#ck_passport").attr("class", "wrong").html(
								"密码由a-z的不限大小写英文字母或0-9的数字组成<br\/>");
						$('#ckpassport').hide();
						$("#ck_passport").show();
						return
					}
					$('#passwordTip').addClass('zczh_zq');
					$("#ck_passport").attr("class", "sure").html("密码输入格式正确<br\/>");
					$('#ckpassport').hide();
					$("#ck_passport").show();
				}else{
					$('#ckpassport').show();
					$("#ck_passport").hide();
				}
			});
	$('#password').focus(function() {
		$('#passwordTip').removeClass();
		$('#passwordTip').addClass('zczh_mr');
		if($('#password').val()==""){
			$('#ckpassport').show();
		}else{
			suggestionPassword($('#password').val());
			$('#ckpassport').hide();
		}
		$("#ck_passport").hide();	});
	$('#password').keyup(function() {
		var password = $(this).val();
		suggestionPassword(password);
		
		if($('#password').val()==""){
			$('#suggestion_password').empty();
			$('#ckpassport').show();
			$("#ck_passport").hide();
		}else{
			$('#ckpassport').hide();
			$("#ck_passport").hide();
		}
	});
	$('#rePassword').blur(
			function() {
				var repassword = $(this).val();
				var password = $("#password").val();

				$('#rePasswordTip').removeClass();

				if (repassword == '' || password == '') {
					return
				}
				if (repassword != password) {
					$('#rePasswordTip').addClass('zczh_cw');
					$("#ck_repassport").attr("class", "wrong").html(
							"密码不一致<br\/>");
					$("#ck_repassport").show()
				} else {
					$('#rePasswordTip').addClass('zczh_zq');
					$("#ck_repassport").attr("class", "sure").html(
							"密码输入一致<br\/>");
					$("#ck_repassport").show()
				}
			});
	$('#rePassword').focus(function() {
		$('#rePasswordTip').removeClass();
		$('#rePasswordTip').addClass('zczh_mr');
		$("#ck_repassport").hide()
	});
	$('#email').blur(
			function() {
				var email = $(this).val();
				var reg = /^([\w.])+\@(([\w])+\.)[a-zA-Z0-9]{2,}/;
				
				if(email!=""){
					if (!reg.test(email)) {
						$('#emailTip').addClass('zczh_cw');
						$("#ck_email").attr("class", "wrong").html(
								"请输入正确邮箱地址<br\/>");
						$('#ckemail').hide();
						$("#ck_email").show();
						return
					}
					if (email != null) {
						
						var data = "-";
						$.getScript("http://passport.zongheng.com/qzdlCheckEmail.do?email=" + email);
						
						var timer = setInterval(
							function() {
								if (data=="-") {
									data = $.qzdlCheckEmail;
									return;
								} else {
									clearInterval(timer);
								}
								$('#emailTip').removeClass();
								if (data == "F") {
									$('#emailTip').addClass('zczh_cw');
									$("#ck_email").attr("class", "wrong").html(
											"此邮箱已使用，请更换其他邮箱。<br\/>");
									$('#ckemail').hide();
									$("#ck_email").show()
								} else if (data == "T") {
									$('#emailTip').addClass('zczh_zq');
									$("#ck_email").attr("class", "sure").html(
											"邮箱输入正确<br\/>");
									$('#ckemail').hide();
									$("#ck_email").show();
								}
							},100);
					}
				}else{
					$('#ckemail').show();
					$("#ck_email").hide();
				}
			});
	$('#email').focus(function() {
		$('#emailTip').removeClass();
		$('#emailTip').addClass('zczh_mr');
		$('#ckemail').show();
		$("#ck_email").hide()
	});
	$('#submit_button').click(function() {
		var userName = $('#userName').val();
		if (userName == "") {
			$('#userNameTip').removeClass();
			$('#userNameTip').addClass('zczh_cw');
			$("#ck_name").attr("class", "sure").html("用户名不能为空<br\/>");
			$('#ckname').hide();
			$("#ck_name").show();
			return
		}
		var nickName = $('#nickName').val();
		if (nickName == "") {
			$('#nickNameTip').removeClass();
			$('#nickNameTip').addClass('zczh_cw');
			$("#ck_nickName").attr("class", "wrong").html("不能为空<br\/>");
			$("#ck_nickName").show();
			$('#cknickName').hide();
			return
		}
		var password = $('#password').val();
		if (password == "") {
			$('#passwordTip').removeClass();
			$('#passwordTip').addClass('zczh_cw');
			$('#ckpassport').hide();
			$("#ck_passport").attr("class", "wrong").html("不能为空<br\/>");
			$("#ck_passport").show();
			return
		}
		var rePassword = $('#rePassword').val();
		if (rePassword == "") {
			$('#rePasswordTip').removeClass();
			$('#rePasswordTip').addClass('zczh_cw');
			$("#ck_repassport").attr("class", "wrong").html("不能为空<br\/>");
			$("#ck_repassport").show();
			return
		}
		if (password != rePassword) {
			return
		}
		
		$("#formreg input[name=location]").val(location.href);
		$("#formreg").attr("action","http://passport.zongheng.com/register.do");
		
		document.formreg.submit();
	});
	function suggestionPassword(word) {
		var wLength = word.length;
		if (wLength < 6 || wLength > 16) {
			$('#suggestion_password').empty();
			$('#suggestion_password').append('<em>无效</em>');
			return
		} else {
			$('#suggestion_password').empty()
		}
		var isNum = hasNumber(word);
		var isCLet = hasCLetter(word);
		var isSLet = hasSLetter(word);
		if (isNum && !isCLet && !isSLet) {
			$('#suggestion_password').empty();
			$('#suggestion_password').append('<em class="red">低</em>')
		} else if (wLength > 12 && isNum && isCLet && isSLet) {
			$('#suggestion_password').empty();
			$('#suggestion_password').append('<em class="green">高</em>')
		} else {
			$('#suggestion_password').empty();
			$('#suggestion_password').append('<em class="blue">中</em>')
		}
	}
	function hasNumber(word) {
		for ( var i = 0; i < word.length; i++) {
			var charCode = word.charCodeAt(i);
			if (charCode >= 48 && charCode <= 58) {
				return true
			}
		}
		return false
	}
	function hasCLetter(word) {
		for ( var i = 0; i < word.length; i++) {
			var charCode = word.charCodeAt(i);
			if (charCode >= 65 && charCode <= 90) {
				return true
			}
		}
		return false
	}
	function hasSLetter(word) {
		for ( var i = 0; i < word.length; i++) {
			var charCode = word.charCodeAt(i);
			if (charCode >= 97 && charCode <= 122) {
				return true
			}
		}
		return false
	}
	
	$.extend({
        qzdlCheckUserName:"-",
        qzdlCheckNickName:"-",
        qzdlCheckEmail:"-"
    });
});